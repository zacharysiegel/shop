---
###############################################################
#                   Authelia configuration                    #
###############################################################
# Within the Authelia container, this file is expected to reside at /config/configuration.yml

theme: dark

server:
  address: 'tcp://:11002'
  endpoints:
    authz:
      auth-request:
        # https://www.authelia.com/integration/proxies/nginx/
        implementation: AuthRequest

log:
  level: trace

totp:
#  issuer: zach.ro
  issuer: authelia

identity_validation:
  reset_password:
#    jwt_secret: 'defined via AUTHELIA_IDENTITY_VALIDATION_RESET_PASSWORD_FILE'

# duo_api:
#  hostname: api-123456789.example.com
#  integration_key: ABCDEF
#  # This secret can also be set using the .env variables AUTHELIA_DUO_API_SECRET_KEY_FILE
#  secret_key: 1234567890abcdefghifjkl

authentication_backend:
  file:
    path: '/data/users_database.yml'

access_control:
  default_policy: deny
  rules:
    # Rules applied to everyone
    - domain: '*.zach.ro'
      policy: one_factor
    - domain: '*.authelia'
      policy: one_factor
#    - domain: 'public.example.com'
#      policy: 'bypass'
#    - domain: 'traefik.example.com'
#      policy: 'one_factor'
#    - domain: 'secure.example.com'
#      policy: 'two_factor'

session:
  # secret defined via AUTHELIA_SESSION_SECRET_FILE

  cookies:
    # https://www.authelia.com/integration/proxies/nginx/
    - name: 'authelia_session'
      domain: 'zach.ro' # Should match whatever your root protected domain is
      # todo: these hosts may need to change to "nginx"
      authelia_url: 'https://zach.ro/auth'
      expiration: '1 hour'
      inactivity: '5 minutes'

regulation:
  max_retries: 5
  find_time: '2 minutes'
  ban_time: '5 minutes'

storage:
  # encryption_key defined via AUTHELIA_STORAGE_ENCRYPTION_KEY_FILE
  postgres:
    address: 'tcp://postgres:5432' # This address is applicable only within the Docker Compose virtual network
    database: authelia
    schema: public
    username: authelia
    # password defined via AUTHELIA_STORAGE_POSTGRES_PASSWORD_FILE
    # Do not connect with TLS

notifier:
  filesystem:
    filename: /data/notification.txt
#  smtp:
#    username: 'test'
#    # This secret can also be set using the .env variables AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE
#    password: 'password'
#    address: 'smtp://mail.example.com:25'
#    sender: 'admin@example.com'
...
